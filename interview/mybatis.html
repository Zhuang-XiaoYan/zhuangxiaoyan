<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Mybatis面试问题 | 庄小焱</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="我是庄小焱，PMP项目管理专家、系统架构设计师(高级)、CSDN博文专家、后端开发工程师。 博主在微服务、虚拟化、系统架构、大数据、机器学习领域不断学习，同时在博客中分享自己学习知识和相关技术， 欢迎大家和我交流学习，欢迎大家关注我的博客。">
    
    <link rel="preload" href="/zhuangxiaoyan/assets/css/0.styles.43ec611f.css" as="style"><link rel="preload" href="/zhuangxiaoyan/assets/js/app.868ae4fe.js" as="script"><link rel="preload" href="/zhuangxiaoyan/assets/js/2.e0e92cc0.js" as="script"><link rel="preload" href="/zhuangxiaoyan/assets/js/10.f03f824c.js" as="script"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/11.8bbceb5f.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/12.14f9a7e9.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/13.875c4422.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/14.b913d772.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/15.04d0022c.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/16.2f5474ed.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/17.314561f8.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/18.4f00aff9.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/19.3198a9c6.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/20.6ca58bc3.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/21.2b13b489.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/22.1ab1c76c.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/23.71e25b05.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/24.ad6ea50e.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/25.76e0a373.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/26.b9862941.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/27.aa410472.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/28.03808d20.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/29.00bd7baa.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/3.08485426.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/30.005c22a8.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/31.93f0d38f.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/32.340f8c91.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/33.4fd282b8.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/34.3a5d80ea.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/35.46a3fd70.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/36.a4d7d4a0.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/37.f4563f51.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/38.a4755c56.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/39.38a44f79.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/4.4d57c8c0.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/40.7ace36ef.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/41.16f6b68f.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/42.6d72579b.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/43.c87acddc.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/44.29fd9c56.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/45.1e066d5b.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/46.38a90e06.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/47.d01627f0.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/48.a24f2064.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/49.b385ae96.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/5.113b6e17.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/50.36614d52.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/51.0a4de0f4.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/52.f34a7e67.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/53.628cf4ca.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/54.cc220f8a.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/55.44be834a.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/56.a10f9160.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/57.889877cb.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/58.35998118.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/59.a96ac910.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/6.1a9b2f20.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/60.69ed00aa.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/61.cd318979.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/62.c1d36d16.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/63.d5921184.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/64.e337ae65.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/65.4754688d.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/66.f1e18825.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/67.90234ef8.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/68.17c41d12.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/69.d424f938.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/7.713b03d2.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/70.dcbc2969.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/71.7dce671a.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/72.ca24dbed.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/73.3746d1d5.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/74.b57bc73f.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/75.9bcbf8d9.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/76.ad9819f6.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/77.1939880d.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/78.d4fe71a2.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/79.95e3a69e.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/8.4562fbf2.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/80.0c9cbcee.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/81.9f9d8638.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/82.4aeef92d.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/83.d69f52f7.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/84.a5ef042c.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/85.c37ffab6.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/86.6d5b65db.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/87.afa8b536.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/88.1c19772d.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/89.5f70dc04.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/9.7d7583a8.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/90.2a690c79.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/91.4d0be90d.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/92.d82b3978.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/93.50ab1b48.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/94.b8bd6e2a.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/95.1fc4557e.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/96.7063edd6.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/97.a7fd9d56.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/98.c7605566.js"><link rel="prefetch" href="/zhuangxiaoyan/assets/js/99.6fe2324c.js">
    <link rel="stylesheet" href="/zhuangxiaoyan/assets/css/0.styles.43ec611f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/zhuangxiaoyan/" class="home-link router-link-active"><!----> <span class="site-name">庄小焱</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/zhuangxiaoyan/resume/" class="nav-link">
  庄小焱简历
</a></div><div class="nav-item"><a href="/zhuangxiaoyan/blog/" class="nav-link">
  庄小焱博客
</a></div><div class="nav-item"><a href="/zhuangxiaoyan/project/" class="nav-link">
  实战项目
</a></div><div class="nav-item"><a href="/zhuangxiaoyan/interview/" class="nav-link router-link-active">
  面试项目
</a></div><div class="nav-item"><a href="/zhuangxiaoyan/ai/" class="nav-link">
  AI项目
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="个人账号" class="dropdown-title"><span class="title">个人账号</span> <span class="arrow down"></span></button> <button type="button" aria-label="个人账号" class="mobile-dropdown-title"><span class="title">个人账号</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://zhuang-xiaoyan.github.io/zhuangxiaoyan/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  庄小焱-博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/Zhuang-XiaoYan" target="_blank" rel="noopener noreferrer" class="nav-link external">
  庄小焱-Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/xjl2462612540" target="_blank" rel="noopener noreferrer" class="nav-link external">
  庄小焱-Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/weixin_41605937" target="_blank" rel="noopener noreferrer" class="nav-link external">
  庄小焱-CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/zhuangxiaoyan/resume/" class="nav-link">
  庄小焱简历
</a></div><div class="nav-item"><a href="/zhuangxiaoyan/blog/" class="nav-link">
  庄小焱博客
</a></div><div class="nav-item"><a href="/zhuangxiaoyan/project/" class="nav-link">
  实战项目
</a></div><div class="nav-item"><a href="/zhuangxiaoyan/interview/" class="nav-link router-link-active">
  面试项目
</a></div><div class="nav-item"><a href="/zhuangxiaoyan/ai/" class="nav-link">
  AI项目
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="个人账号" class="dropdown-title"><span class="title">个人账号</span> <span class="arrow down"></span></button> <button type="button" aria-label="个人账号" class="mobile-dropdown-title"><span class="title">个人账号</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://zhuang-xiaoyan.github.io/zhuangxiaoyan/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  庄小焱-博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/Zhuang-XiaoYan" target="_blank" rel="noopener noreferrer" class="nav-link external">
  庄小焱-Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/xjl2462612540" target="_blank" rel="noopener noreferrer" class="nav-link external">
  庄小焱-Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/weixin_41605937" target="_blank" rel="noopener noreferrer" class="nav-link external">
  庄小焱-CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>分布式设计</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/zhuangxiaoyan/interview/" aria-current="page" class="sidebar-link">场景面试问题总结</a></li><li><a href="/zhuangxiaoyan/interview/distributed-arithmetic.html" class="sidebar-link">分布式原理算法</a></li><li><a href="/zhuangxiaoyan/interview/distributed-id.html" class="sidebar-link">分布式ID原理与设计</a></li><li><a href="/zhuangxiaoyan/interview/distributed-lock.html" class="sidebar-link">分布式锁原理与设计</a></li><li><a href="/zhuangxiaoyan/interview/distributed-transaction.html" class="sidebar-link">分布式事务原理与设计</a></li><li><a href="/zhuangxiaoyan/interview/distributed-throttling.html" class="sidebar-link">分布式限流原理与设计</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Java语言</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/zhuangxiaoyan/interview/java-base.html" class="sidebar-link">java面试问题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>数据库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/zhuangxiaoyan/interview/mysql.html" class="sidebar-link">Mysql面试问题</a></li><li><a href="/zhuangxiaoyan/interview/mysql-backup.html" class="sidebar-link">数据库与缓存一致性</a></li><li><a href="/zhuangxiaoyan/interview/mysql-cluster.html" class="sidebar-link">Mysql主从问题</a></li><li><a href="/zhuangxiaoyan/interview/mysql-slow-query.html" class="sidebar-link">数据查询优化设计</a></li><li><a href="/zhuangxiaoyan/interview/mysql-split-table.html" class="sidebar-link">数据分库分表设计</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>并发编程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/zhuangxiaoyan/interview/juc.html" class="sidebar-link">JUC面试问题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>源码分析</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/zhuangxiaoyan/interview/jdk.html" class="sidebar-link">JDK面试问题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>虚拟机</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/zhuangxiaoyan/interview/jvm.html" class="sidebar-link">JVM面试问题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>计算机网络</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/zhuangxiaoyan/interview/network.html" class="sidebar-link">网络面试问题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>操作系统</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/zhuangxiaoyan/interview/os.html" class="sidebar-link">OS面试问题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Spring框架</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/zhuangxiaoyan/interview/spring.html" class="sidebar-link">spring面试问题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Spring-Cloud框架</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/zhuangxiaoyan/interview/spring-cloud.html" class="sidebar-link">SpringCloud面试问题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>设计模式</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/zhuangxiaoyan/interview/pattern.html" class="sidebar-link">设计模式面试问题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Redis中间件</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/zhuangxiaoyan/interview/redis.html" class="sidebar-link">Redis面试问题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Mybatis框架</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/zhuangxiaoyan/interview/mybatis.html" aria-current="page" class="active sidebar-link">Mybatis面试问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#什么是mybatis" class="sidebar-link">什么是Mybatis</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis的优点" class="sidebar-link">MyBatis的优点</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis框架的缺点" class="sidebar-link">MyBatis框架的缺点</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis框架适用场合" class="sidebar-link">MyBatis框架适用场合</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis与hibernate有哪些不同" class="sidebar-link">MyBatis与Hibernate有哪些不同？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#当实体类中的属性名和表中的字段名不一样-怎么办" class="sidebar-link">当实体类中的属性名和表中的字段名不一样，怎么办？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#模糊查询like语句该怎么写" class="sidebar-link">模糊查询like语句该怎么写?</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis的一级、二级缓存" class="sidebar-link">Mybatis的一级、二级缓存？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#简述mybatis的插件运行原理" class="sidebar-link">简述Mybatis的插件运行原理？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis的一对一、一对多的关联查询" class="sidebar-link">Mybatis的一对一、一对多的关联查询？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis不同的-xml-映射文件-id-是否可以重复" class="sidebar-link">Mybatis不同的 Xml 映射文件，id 是否可以重复？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#xml-映射文件中标签有那些" class="sidebar-link">Xml 映射文件中标签有那些？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis动态sql有什么用" class="sidebar-link">Mybatis动态sql有什么用？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis的流程理解" class="sidebar-link">Mybatis的流程理解？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#使用-mybatis的mapper接口调用时有哪些要求" class="sidebar-link">使用 MyBatis的mapper接口调用时有哪些要求？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#阐述session加载实体对象的过程" class="sidebar-link">阐述Session加载实体对象的过程？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis都有哪些executor执行器" class="sidebar-link">Mybatis都有哪些Executor执行器？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#什么是mybatis的接口绑定-有哪些实现方式" class="sidebar-link">什么是MyBatis的接口绑定？有哪些实现方式？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#接口绑定有两种实现方式" class="sidebar-link">接口绑定有两种实现方式：</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis-是否支持延迟加载-它的实现原理是什么" class="sidebar-link">Mybatis 是否支持延迟加载？它的实现原理是什么？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis-实现一对一有几种方式-具体怎么操作的" class="sidebar-link">MyBatis 实现一对一有几种方式?具体怎么操作的？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#怎么解决sql注入的方法" class="sidebar-link">怎么解决SQL注入的方法</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis是如何进行分页的" class="sidebar-link">Mybatis是如何进行分页的？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis中-和-的区别是什么" class="sidebar-link">Mybatis中#{}和${}的区别是什么？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis中预编译原理" class="sidebar-link">Mybatis中预编译原理</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis中预编译的作用" class="sidebar-link">Mybatis中预编译的作用</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis缓存机制原理" class="sidebar-link">Mybatis缓存机制原理</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#请你介绍mybatis的工作原理" class="sidebar-link">请你介绍Mybatis的工作原理</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis二级缓存的四个不推荐之处" class="sidebar-link">MyBatis二级缓存的四个不推荐之处</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#如何扩展mybatis的缓存" class="sidebar-link">如何扩展Mybatis的缓存？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis的涉及的设计模式" class="sidebar-link">MyBatis的涉及的设计模式?</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#谈谈你对sqlsessionfactory的理解" class="sidebar-link">谈谈你对SqlSessionFactory的理解</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#谈谈你对sqlsession的理解" class="sidebar-link">谈谈你对SqlSession的理解</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#谈谈你对mybatis的理解" class="sidebar-link">谈谈你对Mybatis的理解</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#谈谈mybatis中的分页原理" class="sidebar-link">谈谈MyBatis中的分页原理?</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#spring中是如何解决defaultsqlsession的数据安全问题" class="sidebar-link">Spring中是如何解决DefaultsqlSession的数据安全问题</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis的插件应用" class="sidebar-link">Mybatis的插件应用</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#如何获取mybatis中自增的主键" class="sidebar-link">如何获取MyBatis中自增的主键</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#不同mapper中的id是否可以相同" class="sidebar-link">不同Mapper中的id是否可以相同?</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#谈谈对传统jdbc开发的不足" class="sidebar-link">谈谈对传统JDBC开发的不足?</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis中的编程步骤是什么" class="sidebar-link">MyBatis中的编程步骤是什么？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#sqlsessionfactory是怎么创建的" class="sidebar-link">SqlsessionFactory是怎么创建的？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#configuration的对象创建" class="sidebar-link">Configuration的对象创建？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#建造者模式与工厂模式的区别" class="sidebar-link">建造者模式与工厂模式的区别？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#配置文件加载流程" class="sidebar-link">配置文件加载流程？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#配置的文件解析流程" class="sidebar-link">配置的文件解析流程？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#缓存中装饰器模式实现" class="sidebar-link">缓存中装饰器模式实现？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis的代理设计模式的体现" class="sidebar-link">mybatis的代理设计模式的体现？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#谈谈对mybatis的执行器的理解-executor的原理" class="sidebar-link">谈谈对MyBatis的执行器的理解/Executor的原理？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis中如何实现多个传参" class="sidebar-link">MyBatis中如何实现多个传参?</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#谈谈你对mybatis中的日志的理解" class="sidebar-link">谈谈你对MyBatis中的日志的理解?</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis中记录sql日志的原理" class="sidebar-link">MyBatis中记录SQL日志的原理?</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#代理模式装饰器区别" class="sidebar-link">代理模式装饰器区别？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis中数据源模块的设计" class="sidebar-link">MyBatis中数据源模块的设计?</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis中事务模块的设计" class="sidebar-link">MyBatis中事务模块的设计？</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#mybatis中mapper接口的设计" class="sidebar-link">MyBatis中Mapper接口的设计?</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#为什么需要使用代理对象来处理" class="sidebar-link">为什么需要使用代理对象来处理</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#谈谈你对reflector模块的理解" class="sidebar-link">谈谈你对Reflector模块的理解</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#谈谈你对mybatis中的类型转换模块的理解" class="sidebar-link">谈谈你对MyBatis中的类型转换模块的理解</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#谈谈mybatis和spring的整合的理解" class="sidebar-link">谈谈MyBatis和Spring的整合的理解</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#谈谈你对mybatis的理解-2" class="sidebar-link">谈谈你对MyBatis的理解</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#如何判定一个类是否线程安全" class="sidebar-link">如何判定一个类是否线程安全?</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#sqlsessionfactory和sqlsession是线程安全的吗" class="sidebar-link">SqlSessionFactory和SqlSession是线程安全的吗?</a></li><li class="sidebar-sub-header"><a href="/zhuangxiaoyan/interview/mybatis.html#博文参考" class="sidebar-link">博文参考</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>MQ框架</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/zhuangxiaoyan/interview/mq.html" class="sidebar-link">MQ面试问题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Nginx框架</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/zhuangxiaoyan/interview/nginx.html" class="sidebar-link">nginx面试问题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>微服务设计</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/zhuangxiaoyan/interview/micro-idempotent.html" class="sidebar-link">幂等性原理与设计</a></li><li><a href="/zhuangxiaoyan/interview/micro-auth.html" class="sidebar-link">认证授权设计</a></li><li><a href="/zhuangxiaoyan/interview/micro-encryption.html" class="sidebar-link">加密算法总结</a></li><li><a href="/zhuangxiaoyan/interview/micro-other.html" class="sidebar-link">综合场景面试问题</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="mybatis面试问题"><a href="#mybatis面试问题" class="header-anchor">#</a> Mybatis面试问题</h1> <h2 id="什么是mybatis"><a href="#什么是mybatis" class="header-anchor">#</a> 什么是Mybatis</h2> <ol><li>Mybatis 是一个半 ORM（对象关系映射）框架，它内部封装了 JDBC，开发时 只需要关注 SQL 语句本身，不需要花费精力去处理加载驱动、创建连接、创建 statement 等繁杂的过程。程序员直接编写原生态 sql，可以严格控制 sql 执行性 能，灵活度高。</li> <li>MyBatis 可以使用 XML 或注解来配置和映射原生信息，将 POJO 映射成数 据库中的记录，避免了几乎所有的 JDBC 代码和手动设置参数以及获取结果集。</li> <li>通过 xml 文件或注解的方式将要执行的各种 statement 配置起来，并通过 java 对象和 statement 中 sql 的动态参数进行映射生成最终执行的 sql 语句，最 后由 mybatis 框架执行 sql 并将结果映射为 java 对象并返回。（从执行 sql 到返 回 result 的过程）</li></ol> <h2 id="mybatis的优点"><a href="#mybatis的优点" class="header-anchor">#</a> MyBatis的优点</h2> <ol><li>基于 SQL 语句编程，相当灵活，不会对应用程序或者数据库的现有设计造成任 何影响，SQL 写在 XML 里，解除 sql 与程序代码的耦合，便于统一管理；提供 XML 标签，支持编写动态 SQL 语句，并可重用。</li> <li>与 JDBC 相比，减少了 50%以上的代码量，消除了 JDBC 大量冗余的代码，不 需要手动开关连接；</li> <li>很好的与各种数据库兼容（因为 MyBatis 使用 JDBC 来连接数据库，所以只要 JDBC 支持的数据库 MyBatis 都支持）。</li> <li>能够与 Spring 很好的集成；</li> <li>提供映射标签，支持对象与数据库的 ORM 字段关系映射；提供对象关系映射 标签，支持对象关系组件维护。</li></ol> <h2 id="mybatis框架的缺点"><a href="#mybatis框架的缺点" class="header-anchor">#</a> MyBatis框架的缺点</h2> <ol><li>SQL 语句的编写工作量较大，尤其当字段多、关联表多时，对开发人员编写 SQL 语句的功底有一定要求。</li> <li>SQL 语句依赖于数据库，导致数据库移植性差，不能随意更换数据库。</li></ol> <h2 id="mybatis框架适用场合"><a href="#mybatis框架适用场合" class="header-anchor">#</a> MyBatis框架适用场合</h2> <ol><li>MyBatis 专注于 SQL 本身，是一个足够灵活的 DAO 层解决方案。</li> <li>对性能的要求很高，或者需求变化较多的项目，如互联网项目，MyBatis 将是不错的选择。</li></ol> <h2 id="mybatis与hibernate有哪些不同"><a href="#mybatis与hibernate有哪些不同" class="header-anchor">#</a> MyBatis与Hibernate有哪些不同？</h2> <ol><li>Mybatis 和 hibernate 不同，它不完全是一个 ORM 框架，因为 MyBatis 需要 程序员自己编写 Sql 语句。</li> <li>Mybatis 直接编写原生态 sql，可以严格控制 sql 执行性能，灵活度高，非常 适合对关系数据模型要求不高的软件开发，因为这类软件需求变化频繁，一但需 求变化要求迅速输出成果。但是灵活的前提是 mybatis 无法做到数据库无关性， 如果需要实现支持多种数据库的软件，则需要自定义多套 sql 映射文件，工作量大。</li> <li>Hibernate对象/关系映射能力强，数据库无关性好，对于关系模型要求高的软件，如果用hibernate开发可以节省很多代码，提高效率。</li></ol> <h2 id="当实体类中的属性名和表中的字段名不一样-怎么办"><a href="#当实体类中的属性名和表中的字段名不一样-怎么办" class="header-anchor">#</a> 当实体类中的属性名和表中的字段名不一样，怎么办？</h2> <ol><li><strong>通过在查询的sql语句中定义字段名的别名，让字段名的别名和实体类的属性名一致。</strong></li></ol> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>selectorder<span class="token punctuation">&quot;</span></span> <span class="token attr-name">parametertype</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>int<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultetype</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>net.chenqiong.shop.order<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    select order_id id, order_no orderno ,order_price price form orders where order_id=#{id};
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="2"><li><strong>自定义resultMap标签，设置字段和属性的对应关系。</strong></li></ol> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>getOrder<span class="token punctuation">&quot;</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>int<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>orderresultmap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    select * from orders where order_id=#{id}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>net.chenqiong.shop.order<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>orderresultmap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!–用</span> <span class="token attr-name">id</span> <span class="token attr-name">属性来映射主键字段–</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>order_id<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!–用</span> <span class="token attr-name">result</span> <span class="token attr-name">属性来映射非主键字段，property</span> <span class="token attr-name">为实体类属性名，column为数据表中的属性–</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">&quot;</span>orderno<span class="token punctuation">&quot;</span></span> <span class="token attr-name">column</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>order_no<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>price<span class="token punctuation">&quot;</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>order_price<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>reslutMap</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="模糊查询like语句该怎么写"><a href="#模糊查询like语句该怎么写" class="header-anchor">#</a> 模糊查询like语句该怎么写?</h2> <p><strong>在 Java 代码中添加 sql 通配符。</strong></p> <div class="language-html extra-class"><pre class="language-html"><code>string wildcardname = &quot;%smi%&quot;;
list<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span> names = mapper.selectlike(wildcardname);
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>selectlike<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    select * from foo where bar like #{value}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>在 sql 语句中拼接通配符，会引起 sql 注入</strong></p> <div class="language-html extra-class"><pre class="language-html"><code>string wildcardname = &quot;smi&quot;;
list<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span> names = mapper.selectlike(wildcardname);
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>selectlike<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    select * from foo where bar like &quot;%&quot;#{value}&quot;%&quot;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="mybatis的一级、二级缓存"><a href="#mybatis的一级、二级缓存" class="header-anchor">#</a> Mybatis的一级、二级缓存？</h2> <p><img src="/zhuangxiaoyan/assets/img/Mybatis_sqlsession.c5bf0653.png" alt="img.png"></p> <p><img src="/zhuangxiaoyan/assets/img/Namespaces_cache.47447b67.png" alt="img_1.png"></p> <p>一级缓存: 基于 PerpetualCache 的 HashMap 本地缓存，其存储作用域为 Session，当 Session flush 或 close 之后，
该 Session 中的所有 Cache 就 将清空，默认打开一级缓存。</p> <ol><li>二级缓存与一级缓存其机制相同，默认也是采用 PerpetualCache，HashMap存储，不同在于其存储作用域为 Mapper(Namespace)，并且可自定义存储源，如 Ehcache。默认不打开二级缓存，要开启二级缓存，使用二级缓存属性类需要实现 Serializable 序列化接口(可用来保存对象的状态),可在它的映射文件中配置；</li> <li>对于缓存数据更新机制，当某一个作用域(一级缓存 Session/二级缓存Namespaces)的进行了 C/U/D 操作后，默认该作用域下所有 select 中的缓存将被 clear。</li></ol> <h2 id="简述mybatis的插件运行原理"><a href="#简述mybatis的插件运行原理" class="header-anchor">#</a> 简述Mybatis的插件运行原理？</h2> <p>Mybatis 仅可以编写针对 ParameterHandler、ResultSetHandler、StatementHandler、Executor 这 4 种接口的插件，Mybatis 使用 JDK 的动态代理，为需要拦截的接口生成代理对象以实现接口方法拦截功能，每当执行这 4 种接口对象的方法时，就会进入拦截方法，具体就是 InvocationHandler 的 invoke()方法，当然，只会拦截那些你指定需要拦截的方法。
编写插件：实现 Mybatis 的 Interceptor 接口并复写 intercept()方法，然后在给插件编写注解，指定要拦截哪一个接口的哪些方法即可，记住，别忘了在配置文件中配置你编写的插件。</p> <h2 id="mybatis的一对一、一对多的关联查询"><a href="#mybatis的一对一、一对多的关联查询" class="header-anchor">#</a> Mybatis的一对一、一对多的关联查询？</h2> <p><img src="/zhuangxiaoyan/assets/img/assocation.7d890fc1.png" alt="img.png"></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.lcb.mapping.userMapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--association 一对一关联查询 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>getClass<span class="token punctuation">&quot;</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>int<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ClassesResultMap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        select * from class c,teacher t where c.teacher_id=t.t_id and
        c.c_id=#{id}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.lcb.user.Classes<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ClassesResultMap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 实体类的字段名和数据表的字段名映射 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>c_id<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>c_name<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>association</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>teacher<span class="token punctuation">&quot;</span></span> <span class="token attr-name">javaType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.lcb.user.Teacher<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>t_id<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>t_name<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>association</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--collection 一对多关联查询 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>getClass2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>int<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ClassesResultMap2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        select * from class c,teacher t,student s where c.teacher_id=t.t_id
        and c.c_id=s.class_id and c.c_id=#{id}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.lcb.user.Classes<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ClassesResultMap2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>c_id<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>c_name<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>association</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>teacher<span class="token punctuation">&quot;</span></span> <span class="token attr-name">javaType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.lcb.user.Teacher<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>t_id<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>t_name<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>association</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>collection</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>student<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ofType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.lcb.user.Student<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>s_id<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>s_name<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>collection</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="mybatis不同的-xml-映射文件-id-是否可以重复"><a href="#mybatis不同的-xml-映射文件-id-是否可以重复" class="header-anchor">#</a> Mybatis不同的 Xml 映射文件，id 是否可以重复？</h2> <p>不同的 Xml 映射文件，如果配置了 namespace，那么 id 可以重复；如果没有配置 namespace，那么 id 不能重复；原因就是 namespace+id 是作为 Map的 key使用的，
如果没有 namespace，就剩下 id，那么，id 重复会导致数据互相覆盖。有了 namespace，自然 id 就可以重复，namespace 不同，namespace+id 自然也就不同。</p> <h2 id="xml-映射文件中标签有那些"><a href="#xml-映射文件中标签有那些" class="header-anchor">#</a> Xml 映射文件中标签有那些？</h2> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&lt;</span>select<span class="token operator">&gt;</span>、<span class="token operator">&lt;</span>insert<span class="token operator">&gt;</span>、<span class="token operator">&lt;</span>update<span class="token operator">&gt;</span>、<span class="token operator">&lt;</span>delete<span class="token operator">&gt;</span>、<span class="token operator">&lt;</span>resultMap<span class="token operator">&gt;</span>、<span class="token operator">&lt;</span>parameterMap<span class="token operator">&gt;</span>、<span class="token operator">&lt;</span>sql<span class="token operator">&gt;</span>、<span class="token operator">&lt;</span>include<span class="token operator">&gt;</span>、<span class="token operator">&lt;</span>selectKey<span class="token operator">&gt;</span>。
</code></pre></div><h2 id="mybatis动态sql有什么用"><a href="#mybatis动态sql有什么用" class="header-anchor">#</a> Mybatis动态sql有什么用？</h2> <div class="language-shell extra-class"><pre class="language-shell"><code>Mybatis 动态 sql 可以在 Xml 映射文件内，以标签的形式编写动态 sql，执行原理 是根据表达式的值 完成逻辑判断并动态拼接 sql 的功能。
Mybatis 提供了 <span class="token number">9</span> 种动态 sql 标签：<span class="token operator">&lt;</span>trim<span class="token operator">&gt;</span> 、 <span class="token operator">&lt;</span>where<span class="token operator">&gt;</span> 、<span class="token operator">&lt;</span> <span class="token builtin class-name">set</span> <span class="token operator">&gt;</span>、<span class="token operator">&lt;</span>foreach<span class="token operator">&gt;</span> 、<span class="token operator">&lt;</span>if<span class="token operator">&gt;</span> 、 <span class="token operator">&lt;</span>choose<span class="token operator">&gt;</span> 、<span class="token operator">&lt;</span> when<span class="token operator">&gt;</span> 、<span class="token operator">&lt;</span>otherwise<span class="token operator">&gt;</span> 、 <span class="token operator">&lt;</span>bind<span class="token operator">&gt;</span>。
加上动态 sql 的 <span class="token number">9</span> 个标签，其中为 sql 片段标签，通过标签引入 sql 片段，为不支持自增的主键生成策略标签。
</code></pre></div><h2 id="mybatis的流程理解"><a href="#mybatis的流程理解" class="header-anchor">#</a> Mybatis的流程理解？</h2> <p><img src="/zhuangxiaoyan/assets/img/Mybatis.5965a6a7.png" alt="img.png"></p> <p><strong>MyBatis配置文件</strong></p> <ol><li>config.xml：配置了全局配置文件，配置了MyBatis的运行环境等信息。</li> <li>mapper,xml：sql的映射文件，配置了操作数据库的sql语句，此文件需在config.xml中加载。</li></ol> <p><strong>SqlSessionFactory</strong></p> <p>通过MyBatis环境等配置信息构造SqlSessionFactory(会话工厂)。</p> <p><strong>SqlSession</strong></p> <p>通过会话工厂创建SqlSession(会话)，对数据库进行增删改查操作。</p> <p><strong>Exector执行器</strong></p> <p>MyBatis底层自定义了Exector执行器接口来具体操作数据库，Exector接口有两个实现，一个基本执行器(默认)，一个是缓存执行器，SqlSession底层是通过Exector接口操作数据库。</p> <p><strong>MappedStatement</strong></p> <ol><li>MyBatis的一个底层封装对象，它包装了MyBatis配置信息与sql映射信息等。mapper.xml中的insert/select/update/delete标签对应一个MappedStatement对象。标签的id就是MappedStatement的id。</li> <li>MappedStatement对sql执行输入参数进行定义，包括HashMap、基本类型、pojo、Executor通过MappedStatement在执行sql前将输入的Java对象映射至sql中，输入参数映射就是JDBC编程对preparedStatement设置参数。</li> <li>MappedStatement对sql执行输出结果进行定义，包括HashMap、基本类型、pojo，Executor通过MappedStatement在执行sql后将输出结果映射至Java对象中，输出结果映射就是JDBC编程对结果的解析处理过程。</li></ol> <h2 id="使用-mybatis的mapper接口调用时有哪些要求"><a href="#使用-mybatis的mapper接口调用时有哪些要求" class="header-anchor">#</a> 使用 MyBatis的mapper接口调用时有哪些要求？</h2> <ol><li>Mapper 接口方法名和 mapper.xml 中定义的每个 sql 的 id 相同；</li> <li>Mapper 接口方法的输入参数类型和 mapper.xml 中定义的每个 sql 的 parameterType 的类型相同；</li> <li>Mapper 接口方法的输出参数类型和 mapper.xml 中定义的每个 sql 的 resultType 的类型相同；</li> <li>Mapper.xml 文件中的 namespace 即是 mapper 接口的类路径。</li></ol> <h2 id="阐述session加载实体对象的过程"><a href="#阐述session加载实体对象的过程" class="header-anchor">#</a> 阐述Session加载实体对象的过程？</h2> <ol><li>Session在调用数据库查询功能之前，首先会在一级缓存中通过实体类型和主键进行查找，如果一级缓存查找命中且数据状态合法，则直接返回；</li> <li>如果一级缓存没有命中，接下来Session会在当前NonExists记录（相当于一个查询黑名单，如果出现重复的无效查询可以迅速做出判断，从而提升性能）中进行查找，如果NonExists中存在同样的查询条件，则返回null；</li> <li>如果一级缓存查询失败查询二级缓存，如果二级缓存命中直接返回；</li> <li>如果之前的查询都未命中，则发出SQL语句，如果查询未发现对应记录则将此次查询添加到Session的NonExists中加以记录，并返回null；</li> <li>根据映射配置和SQL语句得到ResultSet，并创建对应的实体对象；</li> <li>将对象纳入Session（一级缓存）的管理；</li> <li>如果有对应的拦截器，则执行拦截器的onLoad方法；</li> <li>如果开启并设置了要使用二级缓存，则将数据对象纳入二级缓存；</li> <li>返回数据对象。</li></ol> <h2 id="mybatis都有哪些executor执行器"><a href="#mybatis都有哪些executor执行器" class="header-anchor">#</a> Mybatis都有哪些Executor执行器？</h2> <p>Mybatis有三种基本的Executor执行器，SimpleExecutor、ReuseExecutor、BatchExecutor。</p> <ol><li>SimpleExecutor：每执行一次update或select，就开启一个Statement对象，用完立刻关闭Statement对象。</li> <li>ReuseExecutor：执行update或select，以sql作为key查找Statement对象，存在就使用，不存在就创建，用完后，不关闭Statement对象，而是放置于Map&lt;String, Statement&gt;内，供下一次使用。简言之，就是重复使用Statement对象。</li> <li>BatchExecutor：执行update（没有select，JDBC批处理不支持select），将所有sql都添加到批处理中（addBatch()），等待统一执行（executeBatch()），它缓存了多个Statement对象，每个Statement对象都是addBatch()完毕后，等待逐一执行executeBatch()批处理。与JDBC批处理相同。</li></ol> <h2 id="什么是mybatis的接口绑定-有哪些实现方式"><a href="#什么是mybatis的接口绑定-有哪些实现方式" class="header-anchor">#</a> 什么是MyBatis的接口绑定？有哪些实现方式？</h2> <p>接口绑定：就是在 MyBatis 中任意定义接口,然后把接口里面的方法和 SQL 语句绑定, 我们直接调用接口方法就可以,这样比起原来了 SqlSession 提供的方法我们可以有更加灵活的选择和设置。</p> <h2 id="接口绑定有两种实现方式"><a href="#接口绑定有两种实现方式" class="header-anchor">#</a> 接口绑定有两种实现方式：</h2> <ol><li>一种是通过注解绑定，就是在接口的方法上面加上@Select、@Update 等注解，里面包含 Sql 语句来绑定；</li> <li>另外一种就是通过 xml里面写 SQL 来绑定, 在这种情况下,要指定 xml 映射文件里面的 namespace 必须为接口的全路径名。当 Sql 语句比较简单时候,用注解绑定, 当 SQL 语句比较复杂时候,用 xml 绑定,一般用 xml 绑定的比较多。</li></ol> <h2 id="mybatis-是否支持延迟加载-它的实现原理是什么"><a href="#mybatis-是否支持延迟加载-它的实现原理是什么" class="header-anchor">#</a> Mybatis 是否支持延迟加载？它的实现原理是什么？</h2> <p>延迟加载:等一会加载。在多表关联查询操作的时候可以使用到的一种方案。如果是单表操作就完全没有延迟加载的概念。
比如。查询用户和部门信息。如果我们仅仅只是需要用户的信息。而不需要用户对应的部门信息。这时就可以使用延迟加载机制来处理。</p> <ol><li>需要开启延迟加载</li> <li>需要配置多表关联</li> <li>Mybatis 仅支持 association 关联对象和 collection 关联集合对象的延迟加载，association 指的就是一对一，collection 指的就是一对多查询。
在 Mybatis 配置文件中，可以配置是否启用延迟加载 lazyLoadingEnabled=true|false。</li></ol> <p>** 延迟加载的原理是使用CGLIB创建目标对象的代理对象**，当调用目标方法时，进入拦截器方法，比如调用 a.getB().getName()，拦截器 invoke()方法发现 a.getB()是null 值，
那么就会单独发送事先保存好的查询关联 B 对象的 sql，把 B 查询上来，然后调用 a.setB(b)，于是 a 的对象 b 属性就有值了，接着完成 a.getB().getName()方法的调用。
这就是延迟加载的基本原理。当然了，不光是 Mybatis，几乎所有的包括 Hibernate，支持延迟加载的原理都是一样的。延迟加载就是在需要用到数据时才进行加载，
不需要用到数据时就不加载数据。延迟加载也称懒加载.</p> <ul><li>好处： 先从单表查询，需要时再从关联表去关联查询，大大提高数据库性能，因为查询单表要比关联查询多张表速度要快。</li> <li>坏处： 因为只有当需要用到数据时，才会进行数据库查询，这样在大批量数据查询时，因为查询工作也要消耗 时间，所以可能造成用户等待时间变长，造成用户体验下降。</li></ul> <h2 id="mybatis-实现一对一有几种方式-具体怎么操作的"><a href="#mybatis-实现一对一有几种方式-具体怎么操作的" class="header-anchor">#</a> MyBatis 实现一对一有几种方式?具体怎么操作的？</h2> <ol><li>有联合查询和嵌套查询,联合查询是几个表联合查询,只查询一次, 通过在resultMap 里面配置 association 节点配置一对一的类就可以完成；</li> <li>嵌套查询是先查一个表，根据这个表里面的结果的 外键 id，去再另外一个表里面查询数据,也是通过 association 配置，但另外一个表的查询通过 select 属性配置。</li></ol> <h2 id="怎么解决sql注入的方法"><a href="#怎么解决sql注入的方法" class="header-anchor">#</a> 怎么解决SQL注入的方法</h2> <ul><li><strong>使用#{}而不是 ${}</strong>：在MyBatis中,使用#{}而不是${}，可以很大程度防止sql注入。因为#{}是一个参数占位符，对于字符串类型，会自动加上&quot;&quot;，其他类型不加。由于Mybatis采用预编译，其后的参数不会再进行SQL编译，所以一定程度上防止SQL注入。${}是一个简单的字符串替换，字符串是什么，就会解析成什么，存在SQL注入风险</li> <li><strong>不要暴露一些不必要的日志或者安全信息</strong>，比如避免直接响应一些sql异常信息:如果SQL发生异常了，不要把这些信息暴露响应给用户，可以自定义异常进行响应。</li> <li><strong>过滤参数中含有的一些数据库关键词</strong>：可以加个参数校验过滤的方法，过滤union，or等数据库关键词</li> <li><strong>适当的权限控制</strong>：在你查询信息时，先校验下当前用户是否有这个权限。比如说，实现代码的时候，可以让用户多传一个企业Id什么的，或者获取当前用户的session信息等，在查询前，先校验一下当前用户是否是这个企业下的等等，是的话才有这个查询员工的权限。</li></ul> <h2 id="mybatis是如何进行分页的"><a href="#mybatis是如何进行分页的" class="header-anchor">#</a> Mybatis是如何进行分页的？</h2> <p>数据进行分页是最基础的功能，一般可以把分页分成两类：</p> <ol><li>逻辑分页，先查询出所有的数据缓存到内存，再根据业务相关需求，从内存数据中筛选出合适的数据进行分页。</li> <li>物理分页 ，直接利用数据库支持的分页语法来实现，比如Mysql里面提供了分页关键词Limit。</li></ol> <p>Mybatis提供了四种分页方式：</p> <ol><li><strong>在Mybatis Mapper配置文件里面直接写分页SQL</strong>，这种方式比较灵活，实现也简单。</li> <li><strong>RowBounds实现逻辑分页</strong>，也就是一次性加载所有符合查询条件的目标数据，根据分页参数值在内存中实现分页。
当然，在数据量比较大的情况下，JDBC驱动本身会做一些优化，也就是不会把所有结果存储在ResultSet里面，而是只加载一部分数据，再根据需求去数据库里面加载。这种方式不适合数据量较大的场景，而且有可能会频繁访问数据库造成比较大的压力。</li> <li><strong>Interceptor拦截器实现</strong>，通过拦截需要分页的select语句，然后在这个sql语句里面动态拼接分页关键字，从而实现分页查询。</li></ol> <ul><li>拦截执行器方法</li> <li>拦截参数的处理</li> <li>拦截结果集的处理</li> <li>拦截SQL语法构建的处理</li></ul> <p><img src="/zhuangxiaoyan/assets/img/mybatis01.1b05de04.png" alt="img.png"></p> <p>这种方式的好处，就是可以提供统一的处理机制，不需要我们再单独去维护分页相关的功能。
4. 插件（PageHelper）及（MyBaits-Plus、tkmybatis）框架实现,这些插件本质上也是使用Mybatis的拦截器来实现的。
只是他们帮我们实现了扩展和封装，节省了分页扩展封装的工作量，在实际开发中，只需要拿来即用即可。</p> <p>总结一下，对于任何ORM框架，分页的实现逻辑无外乎两种，不管怎么包装，最终给到开发者的，只是使用上的差异而已。</p> <p><strong>我认为有三种方式来实现分页：</strong></p> <ol><li>第一种，直接在Select语句上增加数据库提供的分页关键字，然后在应用程序里面传递当前页，以及每页展示条数即可。</li> <li>第二种，使用Mybatis提供的RowBounds对象，实现内存级别分页。</li> <li>第三种，基于Mybatis里面的Interceptor拦截器，在select语句执行之前动态拼接分页关键字。</li></ol> <h2 id="mybatis中-和-的区别是什么"><a href="#mybatis中-和-的区别是什么" class="header-anchor">#</a> Mybatis中#{}和${}的区别是什么？</h2> <ul><li><p>首先，Mybatis提供到的#号占位符和$号占位符，都是实现动态SQL的一种方式，通过这两种方式把参数传递到XML之后，在执行操作之前，Mybatis会对这两种占位符进行动态解析。</p></li> <li><p><strong>#号占位符，等同于jdbc里面的？号占位符。它相当于向PreparedStatement中的预处理语句中设置参数</strong>，而PreparedStatement中的sql语句是预编译的，
SQL语句中使用了占位符，规定了sql语句的结构。<strong>并且在设置参数的时候，如果有特殊字符，会自动进行转义。所以#号占位符可以防止SQL注入</strong>。</p></li> <li><p>而使用$的方式传参，<strong>相当于直接把参数拼接到了原始的SQL里面，Mybatis不会对它进行特殊处理</strong>。</p></li></ul> <h2 id="mybatis中预编译原理"><a href="#mybatis中预编译原理" class="header-anchor">#</a> Mybatis中预编译原理</h2> <ul><li>数据库接受到sql语句之后，需要词法和语义解析，优化sql语句，制定执行计划。</li> <li>如果一条sql语句需要反复执行,每次都进行语法检查和优化，会浪费很多时间。</li> <li>预编译语句就是将sql语句中的值用占位符替代，即将sql语句模板化。一次编译、多次运行，省去了解析优化等过程。</li> <li>mybatis是通过PreparedStatement和占位符来实现预编译的。</li> <li>mybatis底层使用PreparedStatement，默认情况下，将对所有的sql进行预编译。将#替换为?，然后将带有占位符?的sql模板发送至mysql服务器</li> <li>由服务器对此无参数的sql进行编译后，将编译结果缓存，然后直接执行带有真实参数的sql。</li></ul> <h2 id="mybatis中预编译的作用"><a href="#mybatis中预编译的作用" class="header-anchor">#</a> Mybatis中预编译的作用</h2> <ol><li>预编译阶段可以优化 sql的执行。预编译之后的sql多数情况下可以直接执行，数据库服务器不需要再次编译，可以提升性能。</li> <li>预编译语句对象可以重复利用。把一个sql预编译后产生的PreparedStatement 对象缓存下来，下次对于同一个sql，可以直接使用这个缓存的PreparedState 对象。</li> <li>防止SQL注入。使用预编译,而其后注入的参数将不会再进行SQL编译。也就是说其后注入进来的参数系统将不会认为它会是一条SQL语句，而默认其是一个参数。</li></ol> <h2 id="mybatis缓存机制原理"><a href="#mybatis缓存机制原理" class="header-anchor">#</a> Mybatis缓存机制原理</h2> <p>首先，Mybatis里面设计了二级缓存来提升数据的检索效率，避免每次数据的访问都需要去查询数据库。</p> <p><img src="/zhuangxiaoyan/assets/img/Mybatis-cache.54e5fa8d.png" alt="img.png"></p> <p>一级缓存，是SqlSession级别的缓存，也叫本地缓存，因为每个用户在执行查询的时候都需要使用SqlSession来执行，
为了避免每次都去查数据库，Mybatis把查询出来的数据保存到SqlSession的本地缓存中，后续的SQL如果命中缓存，就可以直接从本地缓存读取了。</p> <p>如果想要实现跨SqlSession级别的缓存？那么一级缓存就无法实现了，因此在Mybatis里面引入了二级缓存，就是当多个用户
在查询数据的时候，只有有任何一个SqlSession拿到了数据就会放入到二级缓存里面，其他的SqlSession就可以从二级缓存加载数据。</p> <p>每个一级缓存的具体实现原理是:</p> <p><img src="/zhuangxiaoyan/assets/img/Mybatis-cache02.7eb08cf4.png" alt="img.png"></p> <p>在SqlSession 里面持有一个Executor，每个Executor中有一个LocalCache对象。
当用户发起查询的时候，<strong>Mybatis会根据执行语句在Local Cache里面查询，如果没命中，再去查询数据库并写入到LocalCache，否则直接返回</strong>。
所以，<strong>以及缓存的生命周期是SqlSessiion，而且在多个Sqlsession或者分布式环境下，可能会导致数据库写操作出现脏数据</strong>。</p> <p>二级缓存的具体实现原理是：</p> <p><img src="/zhuangxiaoyan/assets/img/Mybatis-cache03.b27f9226.png" alt="img.png"></p> <p>使用CachingExecutor装饰了Executor，所以在<strong>进入一级缓存的查询流程之前，会先通过CachingExecutor进行二级缓存的查询</strong>。
开启二级缓存以后，<strong>会被多个SqlSession共享，所以它是一个全局缓存。因此它的查询流程是先查二级缓存，再查一级缓存，最后再查数据库</strong>。
另外，MyBatis 的二级缓存相对于一级缓存来说，实现了 SqlSession 之间缓存数据的共享，同时缓存粒度也能够到namespace级别，
并且还可以通过 Cache 接口实现类不同的组合，对 Cache 的可控性也更强。</p> <h2 id="请你介绍mybatis的工作原理"><a href="#请你介绍mybatis的工作原理" class="header-anchor">#</a> 请你介绍Mybatis的工作原理</h2> <ol><li>Mybatis 是一个半 ORM（对象关系映射）框架，它内部封装了JDBC，开发时 只需要关注 SQL 语句本身，不需要花费精力去处理加载驱动、创建连接、创建 statement 等繁杂的过程。程序员直接编写原生态 sql，可以严格控制 sql 执行性 能，灵活度高。</li> <li>Mybatis的框架的初始化操作</li> <li>处理SQL的流程请求。</li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> throwsException<span class="token punctuation">{</span>
        <span class="token comment">// 1.获取配置文价</span>
        <span class="token class-name">Inputstream</span> in<span class="token operator">=</span><span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;mybatis-config.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2.加载解析配置文件并获取SqlSessionFactory对象,sqlsessionFactory 的实例我们没有通过DefaultsqlSessionFactory直接来获取,而是通过一个Builder对象来建造的.</span>
        <span class="token comment">// sqlsessionFactory 生产SqlSession对象的 SqlSessionFactory应该是单例//全局配'置文件和映射文件也只需要在系统启动的时候完成加载操作</span>
        <span class="token comment">// 通过建造者模式来构建复杂的对象:1.完成配置文件的加载解析 2.完成SqlSessionFactory的创建</span>
        sqlsessionFactory factory<span class="token operator">=</span><span class="token keyword">new</span> <span class="token function">sqlsessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 3.根据SqlsessionFactory对象获取Sqlsession对象</span>
        sqlsession sqlsession<span class="token operator">=</span>factory<span class="token punctuation">.</span><span class="token function">opensession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 4.通过Sqlsession中提供的API方法来操作数据库</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> list<span class="token operator">=</span>sqlSession<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span>s<span class="token operator">:</span><span class="token string">&quot;com.boge.mapper.UserHapper.selectUserList&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 获取接口的代码对象﹑得到的其实是通过JDBC代理模式获取的一个代理对象</span>
        <span class="token comment">// UserHapper mapper = sqlSession.getMapper(UserMapper.class);l / PageHelper.startPage(1,2);</span>
        <span class="token comment">//List&lt;User&gt; list = mapper.selectUserList();</span>
        system<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;list.size() = &quot;</span><span class="token operator">+</span>list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>system<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot; - ------------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        system<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;list.size() = &quot;</span><span class="token operator">+</span>list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 5.关闭会话</span>
        sqlsession<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 关闭session 清空一级缓存</span>
        <span class="token comment">// sqlSession = factory.opensession() ;</span>
        <span class="token comment">// mapper = sqlSession.getMapper(UserMapper.class);</span>
        <span class="token comment">// list = mapper.selectUserList() ;</span>
        <span class="token comment">// system .out.println( &quot;list.size() =&quot; + list.size() );</span>
        <span class="token comment">// sqlsession.close();</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="mybatis二级缓存的四个不推荐之处"><a href="#mybatis二级缓存的四个不推荐之处" class="header-anchor">#</a> MyBatis二级缓存的四个不推荐之处</h2> <p>在使用 MyBatis 框架时，可以选择开启二级缓存来提高性能。但是，使用 MyBatis 的二级缓存需要谨慎，并且在大多数情况下，并不推荐使用二级缓存。以下是一些原因：</p> <p><strong>数据不一致性</strong>: 二级缓存是跨会话的，可能存在多个会话同时操作同一数据的情况。当其中一个会话修改了数据后，其他会话获取到的仍然是缓存中的旧数据，导致数据不一致的问题。
需要注意的是，在实际应用中，具体的数据不一致性问题可能更加复杂，涉及到分布式环境、集群部署、缓存管理策略等因素。
因此，在使用 MyBatis 的二级缓存时，需要根据具体的应用场景和需求来评估并合理处理数据一致性的问题。</p> <p><strong>内存占用</strong>: 二级缓存需要将查询结果缓存在内存中，对于大量数据或者查询频繁的场景，会占用较大的内存空间。当系统内存有限时，使用二级缓存可能导致内存溢出的问题。
当使用 MyBatis 的二级缓存时，会将查询的结果对象缓存在内存中，以便在后续的查询中直接使用，从而减少数据库访问次数，提高性能。但是，如果数据量较大或者缓存管理不当，二级缓存可能会占用过多的内存。
这其中涉及到整个查询结果集的存储，包括用户对象及其关联对象等，如果数据量较大，二级缓存可能导致内存的过度占用，从而影响系统的性能和稳定性。为了解决这个问题，可以采取以下策略：</p> <ol><li>调整二级缓存的配置，例如使用 LRU（最近最少使用）策略、设置合理的缓存大小等，以平衡内存占用和性能之间的权衡。</li> <li>考虑在查询中使用分页来限制缓存的大小，只查询需要的数据量，避免加载过多的数据到内存中。</li> <li>根据具体业务场景，评估是否真正需要使用二级缓存，有些查询可能更适合直接从数据库获取最新数据。</li></ol> <p>需要根据实际情况和具体需求来评估并合理处理二级缓存可能导致的内存占用问题。</p> <p><strong>延迟问题</strong>: 由于需要维护缓存的一致性，二级缓存可能引入一定的延迟。当数据发生更新时，会导致缓存失效，下一次查询需要重新从数据库加载数据，可能引起稍微的延迟。
当使用 MyBatis 的二级缓存时，由于缓存的存在，可能会导致数据的延迟更新问题。这意味着在数据库中执行更新操作后，其他会话或线程可能仍然使用旧的缓存数据，而不是最新的数据库数据。
这就是二级缓存可能导致的延迟更新问题。这对于需要及时获取最新数据的场景来说，可能是一个潜在的风险。为了解决这个问题，可以采取以下策略：</p> <ol><li>可以通过手动清除缓存或者设置合理的刷新策略，确保在更新操作后及时刷新缓存数据。</li> <li>根据具体业务需求，评估是否真正需要使用二级缓存。有些场景可能更适合关闭二级缓存，直接从数据库获取最新数据。</li></ol> <p>需要根据实际情况和具体需求来评估并合理处理二级缓存可能导致的延迟更新问题。</p> <p><strong>不适用于复杂查询</strong>: 二级缓存适用于简单且频繁被访问的查询，对于复杂的查询语句、多表关联查询等，缓存的效果可能并不理想。
这是因为复杂查询涉及多个表或者多个条件，缓存的命中率较低，反而增加了额外的开销。</p> <p>MyBatis 的二级缓存主要适用于经常被重复查询的简单查询场景。对于复杂查询，二级缓存可能会导致缓存的命中率下降，甚至产生错误的结果。
因此，在复杂查询的情况下，不建议使用 MyBatis 的二级缓存。</p> <p>这就是在复杂查询场景下，MyBatis 的二级缓存可能产生错误结果的问题。由于二级缓存无法感知关联数据的变化，当关联数据发生更新时，会导致缓存的数据不一致。
<strong>针对复杂查询场景，建议关闭 MyBatis 的二级缓存，通过手动清除缓存或设置合理的刷新策略，确保查询结果的准确性。</strong></p> <p>尽管 MyBatis 提供了二级缓存功能，但在大多数情况下，我们更推荐通过合理优化 SQL 查询、数据库索引等手段来提高性能。如果需要缓存查询结果，
可以考虑使用其他缓存方案，如 Redis、Memcached 等，这些方案通常提供更好的可扩展性和缓存管理机制。
同时，使用本地缓存（一级缓存）来减少数据库查询次数也是一个不错的选择。综上所述，根据具体场景选择合适的缓存方案是很重要的。</p> <h2 id="如何扩展mybatis的缓存"><a href="#如何扩展mybatis的缓存" class="header-anchor">#</a> 如何扩展Mybatis的缓存？</h2> <ol><li>创建Cache接口的实现类，重写getObject和putObject方法。</li> <li>配置xml 文件中 <code>&lt;caphe type=&quot;org.mybatis.caches.ehcache.Ehcachecache&quot;/&gt;</code></li></ol> <h2 id="mybatis的涉及的设计模式"><a href="#mybatis的涉及的设计模式" class="header-anchor">#</a> MyBatis的涉及的设计模式?</h2> <ol><li>在缓存中使用的装饰器模式： 在装饰器模式用用来被装饰的对象缓存中的基本缓存处理的实现其实就是一个HashMap的基本操作。
PerpetualCache针对缓存实现灵活的配置需求，1.缓存数据淘汰机制、2.缓存数据的存放机制、3.缓存数据添加是否同步/阻塞、4.缓存对象是否做同步处理。</li> <li>日志模块中使用适配器模式: 在Mybatis的日志类中实现多种日志的框架，适配了常见的日志框架。</li> <li>JDBC中使用的代理模式。实现使用代理对象连接数据库。</li> <li>Mappering 使用代理模式。</li> <li>反射模块中使用工厂模式与的装饰器模式。</li> <li>SqlSessionFactory 建造者模式。</li> <li>模板方法。</li></ol> <h2 id="谈谈你对sqlsessionfactory的理解"><a href="#谈谈你对sqlsessionfactory的理解" class="header-anchor">#</a> 谈谈你对SqlSessionFactory的理解</h2> <ol><li>SqlSessionFactory是MyBatis中非常核心的一个API。是一个SqlSessionFactory工厂。<strong>目的是创建sqlSession对象。SqlSessionFactory应该是单例</strong>。</li> <li><strong>SqlSessionFactory对象的创建是通过SqlSessionFactoryBuilder来实现</strong>。在<strong>SqlSessionFactoryBuilder即完成了SqlSessionFactory对象的创建。
也完成了全局配置文件和相关的映射文件的加载和解析操作。相关的加载解析的信息会被保存在Configuration对象中</strong>。</li> <li>而且涉及到了两种涉及模式:<strong>工厂模式，建造者模式</strong>。</li></ol> <h2 id="谈谈你对sqlsession的理解"><a href="#谈谈你对sqlsession的理解" class="header-anchor">#</a> 谈谈你对SqlSession的理解</h2> <ol><li>SqlSession是MyBatis中非常核心的一个API，<strong>SqlSession的作用是通过相关API来实现对应的数据库数据的操作</strong>。</li> <li><strong>SqlSession对象的获取需要通过SqlSessionFactory来实现</strong>。是一个会话级别的。当一个新的会话到来的时候。我们需要新建一个SqlSession对象来处理。当一个会话结束后我们需要关闭相关的会话资源。</li> <li>处理请求的方式:<strong>1.通过相关的增删改查的API直接处理 2.可以通过getMapper(xxx.class)来获取相关的mapper接口的代理对象来处理</strong>。</li></ol> <h2 id="谈谈你对mybatis的理解"><a href="#谈谈你对mybatis的理解" class="header-anchor">#</a> 谈谈你对Mybatis的理解</h2> <ol><li>MyBatis应该是我们在工作中使用频率最高的一个ORM框架。持久层框架，提供非常方便的API来实现增删改查操作。</li> <li>支持灵活的缓存处理方案，—级缓存、二级缓存，三级缓存。</li> <li>还支持相关的延迟数据加载的处理</li> <li>还提供了非常多的灵活标签来实现复杂的业务处理，if forech where trim set bind ...</li> <li>相比于Hibernate会更加的灵活。相比于Hibernate全自动框架来说对于复杂的业务更具有灵活性。</li></ol> <h2 id="谈谈mybatis中的分页原理"><a href="#谈谈mybatis中的分页原理" class="header-anchor">#</a> 谈谈MyBatis中的分页原理?</h2> <ol><li>谈谈分页的理解:数据太多。用户并不需要这么多。我们的内存也放不下这么多的数据SQL: <strong>MySQL : limit关键字，Oracle: rowid关键字</strong></li> <li>谈谈MyBatis中的分页实现在MyBatis中实现分页有两种实现: <strong>1.逻辑分页:RowBounds、2.物理分页:拦截器实现(通过的拦截器实现的关键字的拼接来实现分页)</strong></li></ol> <h2 id="spring中是如何解决defaultsqlsession的数据安全问题"><a href="#spring中是如何解决defaultsqlsession的数据安全问题" class="header-anchor">#</a> Spring中是如何解决DefaultsqlSession的数据安全问题</h2> <ul><li><p><strong>每个都应该有它自己的Sqlsession实例。 sqlsession实例不是线程安全的，因此是不能共享的，所以它的最佳的作用划是请求方法作用域</strong>。
绝对不能将sqlsession实例的引用放在一个类的静态域，甚至一个类的实例变量都是不行的。也绝对不能将sqlsession的实例引用放在任何类型托管作用域中，比如servlet框架中的httpsession。
如果你现在正在使用一种Web 框架，考虑将SqlSession 放在一个和HTTP请求相似的作用域中。换句话说,每次收到HTTP请求，就可以打开—个SqlSession，
返回一个响应后，就关闭它。这个关闭操作很重要，为了确保每次都能执行关闭操作，你应该把这个关闭操作放到finally块中。</p></li> <li><p>DefaultSqlSession是线程非安全的。也就意味着我们不能够把DefaultSqlSession声明在成员变量中。</p></li> <li><p><strong>在Spring中提供了一个SqlSession Template来实现SqlSession的相关的定义。然后在SqlSessionTemplate中的每个方法都通过SqlSessionProxy来操作</strong>。
这个是一个动态代理对象。然后在动态代理对象中通过方法级别的DefaultSqlSession来实现相关的数据库的操作。</p></li></ul> <h2 id="mybatis的插件应用"><a href="#mybatis的插件应用" class="header-anchor">#</a> Mybatis的插件应用</h2> <p>mybatis的插件: MyBatis允许你在映射语句执行过程中的某一点进行拦截调用。
MyBatis中的插件设计的目的是什么:方便我们开发人员实现对MyBatis功能的增强。默认情况下，MyBatis 允许使用插件来拦截的方法调用包括：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Executor</span> <span class="token punctuation">(</span>update<span class="token punctuation">,</span> query<span class="token punctuation">,</span> flushStatements<span class="token punctuation">,</span> commit<span class="token punctuation">,</span> rollback<span class="token punctuation">,</span> getTransaction<span class="token punctuation">,</span> close<span class="token punctuation">,</span> isClosed<span class="token punctuation">)</span>
<span class="token class-name">ParameterHandler</span> <span class="token punctuation">(</span>getParameterObject<span class="token punctuation">,</span> setParameters<span class="token punctuation">)</span>
<span class="token class-name">ResultSetHandler</span> <span class="token punctuation">(</span>handleResultSets<span class="token punctuation">,</span> handleOutputParameters<span class="token punctuation">)</span>
<span class="token class-name">StatementHandler</span> <span class="token punctuation">(</span>prepare<span class="token punctuation">,</span> parameterize<span class="token punctuation">,</span> batch<span class="token punctuation">,</span> update<span class="token punctuation">,</span> query<span class="token punctuation">)</span>
</code></pre></div><p>通过 MyBatis 提供的强大机制，使用插件是非常简单的，只需实现 Interceptor 接口，并指定想要拦截的方法签名即可。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// ExamplePlugin.java</span>
<span class="token annotation punctuation">@Intercepts</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token annotation punctuation">@Signature</span><span class="token punctuation">(</span>
  type<span class="token operator">=</span> <span class="token class-name">Executor</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
  method <span class="token operator">=</span> <span class="token string">&quot;update&quot;</span><span class="token punctuation">,</span>
  args <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">MappedStatement</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExamplePlugin</span> <span class="token keyword">implements</span> <span class="token class-name">Interceptor</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">Properties</span> properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">intercept</span><span class="token punctuation">(</span><span class="token class-name">Invocation</span> invocation<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
    <span class="token comment">// implement pre processing if need</span>
    <span class="token class-name">Object</span> returnObject <span class="token operator">=</span> invocation<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// implement post processing if need</span>
    <span class="token keyword">return</span> returnObject<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setProperties</span><span class="token punctuation">(</span><span class="token class-name">Properties</span> properties<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>properties <span class="token operator">=</span> properties<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- mybatis-config.xml --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span> <span class="token attr-name">interceptor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.mybatis.example.ExamplePlugin<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>someProperty<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>我们可以通过拦截器做哪些操作</p> <ol><li>检查执行的SQL。比如sql中有select * . delete from .. 。</li> <li>对执行的SQL的参数做处理</li> <li>对查询的结果做装饰处理4.对查询SQL的分表处理</li></ol> <h2 id="如何获取mybatis中自增的主键"><a href="#如何获取mybatis中自增的主键" class="header-anchor">#</a> 如何获取MyBatis中自增的主键</h2> <p>需要获取自增的主键:在同一个事务中操作多表。我们需要关联的id信息。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>  <span class="token attr-name">useGenerateKeys</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">keyProperty</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">User</span> user<span class="token operator">=</span><span class="token keyword">new</span> <span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
userMapper<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;使用的主键是：&quot;</span><span class="token operator">+</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="不同mapper中的id是否可以相同"><a href="#不同mapper中的id是否可以相同" class="header-anchor">#</a> 不同Mapper中的id是否可以相同?</h2> <p>可以相同:每一个映射文件的namespace都会设置为对应的mapper接口的全类路径名称。也就是保证了每一个Mapper映射文件的namespace是惟一的。
那么我们只需要满足在同一个映射文件中的id是不同的就可以了。</p> <ul><li>UserMapper.xml: com.boge.mapper.UserMapper #selectList</li> <li>RoleMapper.xml com.boge.mapper.RoleMapper # selectList</li></ul> <h2 id="谈谈对传统jdbc开发的不足"><a href="#谈谈对传统jdbc开发的不足" class="header-anchor">#</a> 谈谈对传统JDBC开发的不足?</h2> <ol><li>我们需要频繁的创建和释放数据库库的连接对象，会造成系统资源的浪费，从而影响系统的性能,针对与这个情况我们的解决方案是数据库连接池。
然后在MyBatis中的全局配置文件中我们可以设置相关的数据库连接池。当然和Spring整合后我们也可以配置相关的数据库连接。</li> <li>SQL语句我们是直接添加到了代码中了，造成维护的成本增加。所以对应SQL的动态性要求比较高。这时我们可以考虑把SQL和我们的代码分离，
在MyBatis中专门提供了映射文件。我们在映射文件中通过标签来写相关的SQL。</li> <li>向SQL中传递参数也很麻烦，因为SQL语句的where条件不一定。可能有很多值也可能很少。占位符和参数需要——对应。
在MyBatis中自动完成java对象和sql中参数的映射。</li> <li>对于结果集的映射也很麻烦，主要是SQL本身的变化会导致解析的难度。我们的解决方案。在MyBatis中通过ResultSetHandler来自动把结果集映射到对应的Java对象中。</li> <li>传统的JDBC操作不支持事务。缓存。延迟加载等功能。在MyBatis都提供了相关的实现。</li></ol> <h2 id="mybatis中的编程步骤是什么"><a href="#mybatis中的编程步骤是什么" class="header-anchor">#</a> MyBatis中的编程步骤是什么？</h2> <ol><li>创建SqlSessionFactory--》SqlSessionFactoryBuilder --》建造成模式--》Configuration</li> <li>通过创建的SqlSessionFactory对象来获取SqlSession对象--》Executor执行器</li> <li>通过SqlSession对象执行数据库操作-》API和Mapper接口代理对象--》缓存--》装饰者模式</li> <li>调用SqISession中的commit方法来显示的提交事务--》数据源和事务模块--》JDBC和Managed</li> <li>调式SqlSession中的close方法来关闭会话</li></ol> <h2 id="sqlsessionfactory是怎么创建的"><a href="#sqlsessionfactory是怎么创建的" class="header-anchor">#</a> SqlsessionFactory是怎么创建的？</h2> <p><img src="/zhuangxiaoyan/assets/img/mybatis-SqlsessionFactory.1a91365c.png" alt="img.png"></p> <p>使用 MyBatis 首先是使用配置或者代码去生产SqlSessionFactory，而 MyBatis 提供了构造器 SqlSessionFactoryBuilder。
MyBatis提供了一个类org.apache.ibatis.session.Configuration 作为引导，采用的是Builder模式。具体的分步则是在Configuration类里面完成的。
在 MyBatis 中，既可以通过读取配置的 XML 文件的形式生成 SqlSessionFactory，也可以通过Java代码的形式去生成 SqlSessionFactory。
推荐采用 XML 的形式，因为代码的方式在需要修改的时候会比较麻烦。当配置了 XML 或者提供代码后，MyBatis 会读取配置文件，通过 Configuration 类对象构建整个 MyBatis 的上下文。</p> <p>SqlSessionFactory 是一个接口，在 MyBatis 中它存在两个实现类：SqlSessionManager 和 DefaultSqlSessionFactory。
一般而言，具体是由 DefaultSqlSessionFactory 去实现的，而 SqlSessionManager 使用在多线程的环境中，它的具体实现依靠 DefaultSqlSessionFactory，</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestMyBatis</span> <span class="token punctuation">{</span>
   
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// 基本mybatis环境</span>
            <span class="token comment">// 1.定义mybatis_config文件地址</span>
            <span class="token class-name">String</span> resources <span class="token operator">=</span> <span class="token string">&quot;mybatis_config.xml&quot;</span><span class="token punctuation">;</span>
            <span class="token comment">// 2.获取InputStreamReaderIo流</span>
            <span class="token class-name">Reader</span> reader <span class="token operator">=</span> <span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">getResourceAsReader</span><span class="token punctuation">(</span>resources<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 3.获取SqlSessionFactory</span>
            <span class="token class-name">SqlSessionFactory</span> sqlSessionFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 4.获取Session</span>
            <span class="token class-name">SqlSession</span> sqlSession <span class="token operator">=</span> sqlSessionFactory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 5.操作Mapper接口</span>
            <span class="token class-name">UserMapper</span> mapper <span class="token operator">=</span> sqlSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">UserMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">UserEntity</span> user <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">getUser</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="configuration的对象创建"><a href="#configuration的对象创建" class="header-anchor">#</a> Configuration的对象创建？</h2> <p>Mybatis所有的配置信息以及mapper的配置信息，全部存储于Configuration对象中，Configuration相当于Mybatis的对象实体。
Configuration对象从初始创建会一直贯穿Mybatis运行的整个生命周期，为Mybatis的运行提供必要的配置信息。Mybatis全局配置对象创建的过程，就是给Configuration对象中属性赋值的过程。</p> <p>首先，在Mybatis开始运行时，首先需要创建SqlSessionFactoryBuilder对象，在调用该对象的build方法时，把读取了主配置文件的输入流作为参数来创建SqlSessionFactory对象。</p> <p>可以直接进入到build的方法中查看其执行过程,在SqlSessionFactoryBuilder类中存在多个重载的方法，名字都为build，最终都会执行参数为configuration的方法，而configuration对象就是由XMLConfigbuilder对象的parse方法返回。</p> <h2 id="建造者模式与工厂模式的区别"><a href="#建造者模式与工厂模式的区别" class="header-anchor">#</a> 建造者模式与工厂模式的区别？</h2> <ol><li><strong>在工厂方法模式里，我们关注的是一个产品整体，如超人整体，无须关心产品的各部分是如何创建出来的；但在建造者模式中，一个具体产品的产生是依赖各个部件的产生以及装配顺序，它关注的是“由零件一步一步地组装出产品对象”。简单地说，工厂模式是一个对象创建的粗线条应用，建造者模式则是通过细线条勾勒出一个复杂对象，关注的是产品组成部分的创建过程。</strong></li> <li><strong>工厂方法模式创建的产品一般都是单一性质产品，如成年超人，都是一个模样，而建造者模式创建的则是一个复合产品，它由各个部件复合而成，部件不同产品对象当然不同。这不是说工厂方法模式创建的对象简单，而是指它们的粒度大小不同。一般来说，工厂方法模式的对象粒度比较粗，建造者模式的产品对象粒度比较细。</strong></li></ol> <p>两者的区别有了，那在具体的应用中，我们该如何选择呢？是用工厂方法模式来创建对象，还是用建造者模式来创建对象，<strong>这完全取决于我们在做系统设计时的意图，如果需要详细关注一个产品部件的生产、安装步骤，则选择建造者，否则选择工厂方法模式。</strong></p> <h2 id="配置文件加载流程"><a href="#配置文件加载流程" class="header-anchor">#</a> 配置文件加载流程？</h2> <h2 id="配置的文件解析流程"><a href="#配置的文件解析流程" class="header-anchor">#</a> 配置的文件解析流程？</h2> <h2 id="缓存中装饰器模式实现"><a href="#缓存中装饰器模式实现" class="header-anchor">#</a> 缓存中装饰器模式实现？</h2> <p><strong>装饰器模式（Decorator Pattern）允许向一个现有的对象添加新的功能，同时又不改变其结构。这种类型的设计模式属于结构型模式</strong>
它是作为现有的类的一个包装。简单说就是对同一接口添加新功能时，需要新增一个类，被改造的接口定义为delete（委托）。</p> <p>以mybatis中的二级缓存Cache为推荐。在定义缓存Cache接口，实现各类缓存操作。</p> <ol><li>PerpetualCache，基于HashMap实现了内存的缓存操作。</li> <li>LruCache，基于LRU策略删除缓存的实现类。</li> <li>FifoCache，缓存基于FIFO先进先出的策略获取缓存的实现类。</li> <li>LoggingCache，为日志统一添加日志的实现类。</li></ol> <p><img src="/zhuangxiaoyan/assets/img/mybatis-decoratoe.64d7ff69.jpg" alt="img.png"></p> <h2 id="mybatis的代理设计模式的体现"><a href="#mybatis的代理设计模式的体现" class="header-anchor">#</a> mybatis的代理设计模式的体现？</h2> <p><strong>代理模式(Proxy Pattern)：给某⼀个对象提供⼀个代理，并由代理对象控制对原对象的引⽤。它是⼀种对象结构型模式。</strong>
代理模式可以认为是Mybatis的核⼼使⽤的模式，正是由于这个模式，我们只需要编写Mapper.java接口，不需要实现，由Mybatis后台帮我们完成具体SQL的执⾏。</p> <p>MapperMethod类是整个代理机制的核心类，对SqlSession中的操作进行了封装使用。 该类里有两个内部类SqlCommand和MethodSignature。
SqlCommand用来封装CRUD操作，也就是我们在xml中配置的操作的节点。每个节点都会生成一个MappedStatement类。
MethodSignature用来封装方法的参数以及返回类型，在execute的方法中又回到了SqlSession中的接口调用，和
自己实现UerDao接口的方式中直接用SqlSession对象调用DefaultSqlSession的实现类的方法是一样的，这就是整个动态代理的实现过程了。</p> <h2 id="谈谈对mybatis的执行器的理解-executor的原理"><a href="#谈谈对mybatis的执行器的理解-executor的原理" class="header-anchor">#</a> 谈谈对MyBatis的执行器的理解/Executor的原理？</h2> <p>Executor的类型有三类:</p> <ol><li>SIMPLE:默认SimpleExecutor:每次操作都是一个新的Statement对象。</li> <li>REUSE: ReuseExecutor，会根据SQL缓存Statement对象。实现Statement对象的复用。</li> <li>BATCH: BatchExecutor批处理。</li></ol> <p>如何指定我们需要使用的类型呢?</p> <ol><li>可以通过SqlSessionFactory的openSession方法中来指导对应的处理器类型。</li> <li>可以通过全局配置文件中的settings来配置默认的执行器。</li></ol> <h2 id="mybatis中如何实现多个传参"><a href="#mybatis中如何实现多个传参" class="header-anchor">#</a> MyBatis中如何实现多个传参?</h2> <ol><li><strong>顺序传值</strong></li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">selectUser</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span><span class="token keyword">int</span> deptId<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token attr-name">selectuser&quot;</span> <span class="token attr-name">resultNap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>baseResultNap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    select * from t_user where user_name = #{0} and dept_id= #{1}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>#{}里面的数字代表的是入参的顺序,但是这种方法不建议使用，SQL层次表达不直观，而且一旦循序错了很难找到。</p> <ol start="2"><li><strong>@Param注解传值</strong></li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">selectUser</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token class-name">String</span> name<span class="token punctuation">,</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">&quot;deptId&quot;</span><span class="token punctuation">)</span><span class="token keyword">int</span> deptId<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token attr-name">selectuser&quot;</span> <span class="token attr-name">resultNap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>baseResultNap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    select * from t_user where user_name = #{name} and dept_id= #{deptId}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>#{}里面的名称对应的就是@Param注解中修饰的名称。</p> <ol start="3"><li><strong>Map注解传值</strong></li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">selectUser</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span>object<span class="token punctuation">&gt;</span></span> map<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>selectUser” parameterType=<span class="token punctuation">&quot;</span></span><span class="token attr-name">java.util.Map&quot;</span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>baseResultMap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
select * from t_user where user_name = #{name} and dept_id= #{deptId}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>#{}里面的名称就是Map中对应的Key，这种方案适合传递多个参数，且参数灵活应变值得推荐。</p> <ol start="4"><li><strong>通过自定义的对象传递</strong></li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">selectUser</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>selectUser” parameterType=<span class="token punctuation">&quot;</span></span><span class="token attr-name">com.zhuangxiaoyan.mybatis&quot;</span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>baseResultMap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
select * from t_user where user_name = #{name} and dept_id= #{deptId}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>#{}里面的名称就是自定义对象的属性名称。这样的方式很直观的。也是推荐使用。</p> <h2 id="谈谈你对mybatis中的日志的理解"><a href="#谈谈你对mybatis中的日志的理解" class="header-anchor">#</a> 谈谈你对MyBatis中的日志的理解?</h2> <ol><li>MyBatis中的日志模块使用了适配器模式。</li> <li>如果我们需要适配MyBatis没有提供的日志框架。那么对应的需要添加相关的适配类，并实现的log的接口。</li> <li>在全局配置文件中设置日志的的实现。</li> <li>在Mybatis中框架中提供jdbc的package 这个包里面实现了jdbc的相关操作的日志记录。</li></ol> <h2 id="mybatis中记录sql日志的原理"><a href="#mybatis中记录sql日志的原理" class="header-anchor">#</a> MyBatis中记录SQL日志的原理?</h2> <p>在MyBatis中对执行JDBC操作的日志记录的本质是创建了相关核心对象的代理对象.</p> <ol><li>Connection -- ConnectionLogger</li> <li>PreparedStatement -- PreparedStatementLogger</li> <li>ResultSet --ResultSetLogger</li></ol> <p><strong>本质就是通过代理对象来实现的。代理对象中完成相关的日志操作。然后再调用对应的目标对象完成相关的数据库的操作处理。</strong></p> <h2 id="代理模式装饰器区别"><a href="#代理模式装饰器区别" class="header-anchor">#</a> 代理模式装饰器区别？</h2> <p><strong>代理模式(Proxy Design Pattern)原始定义是</strong>:让你能够提供对象的替代品或其占位符。代理控制着对于原对象的访问，并允许将请求提交给对象前后进行一些处理。</p> <p><strong>代理模式的适用场景</strong></p> <ol><li>功能增强：当需要对一个对象的访问提供一些额外操作时,可以使用代理模式</li> <li>远程(Remote)代理：实际上，RPC框架也可以看作一种代理模式，GoF的《设计模式》一书中把它称作远程代理。通过远程代理，将网络通信、数据编解码等细节隐藏起来。
客户端在使用RPC 服务的时候，就像使用本地函数一样，无需了解跟服务器交互的细节。除此之外，RPC 服务的开发者也只需要开发业务逻辑，就像开发本地使用的函数一样，不需要关注跟客户端的交互细节。</li> <li>防火墙(Firewall)代理： 当你将浏览器配置成使用代理功能时，防火墙就将你的浏览器的请求转给互联网;当互联网返回响应时，代理服务器再把它转给你的浏览器。</li> <li>保护(Protect or Access)代理：控制对一个对象的访问，如果需要，可以给不同的用户提供不同级别的使用权限。</li></ol> <p><strong>装饰模式(decorator pattern)的原始定义是</strong>:动态的给一个对象添加一些额外的职责.就扩展功能而言,装饰器模式提供了一种比使用子类更加灵活的替代方案.</p> <p><strong>装饰器模式的适用场景</strong></p> <ol><li>快速动态扩展和撤销一个类的功能场景。比如，有的场景下对API接口的安全性要求较高，那么就可以使用装饰模式对传输的字符串数据进行压缩或加密。如果安全性要求不高，则可以不使用。</li> <li>不支持继承扩展类的场景。比如，使用final关键字的类，或者系统中存在大量通过继承产生的子类。</li></ol> <p><strong>装饰器模式与代理模式的区别</strong></p> <p>对装饰器模式来说，装饰者(decorator)和被装饰者(decoratee)都实现同一个接口。对代理模式来说，代理类(proxy class)和真实处理的类(real class)都实现同一个接口。
他们之间的边界确实比较模糊，两者都是对类的方法进行扩展，具体区别如下:</p> <ol><li><strong>装饰器模式强调的是增强自身，在被装饰之后你能够在被增强的类上使用增强后的功能。增强后你还是你，只不过能力更强了而已</strong>;
<strong>代理模式强调要让别人帮你去做一些本身与你业务没有太多关系的职责（记录日志、设置缓存)。代理模式是为了实现对象的控制</strong>，因为被代理的对象往往难以直接获得或者是其内部不想暴露出来。</li> <li>装饰模式是以对客户端透明的方式扩展对象的功能，是继承方案的一个替代方案;代理模式则是给一个对象提供一个代理对象，并由代理对象来控制对原有对象的引用;</li> <li>装饰模式是为装饰的对象增强功能;而代理模式对代理的对象施加控制，但不对对象本身的功能进行增强;</li></ol> <h2 id="mybatis中数据源模块的设计"><a href="#mybatis中数据源模块的设计" class="header-anchor">#</a> MyBatis中数据源模块的设计?</h2> <p>UnpooledDataSource:非数据源连接池的实现
PooledDataSource:数据库连接池的实现</p> <ol><li>从连接池中获取连接对象:如果有空闲连接直接返回。活跃连接数是否超过了最大连接数。是否有连接超时的连接.</li> <li>数据库连接池关闭连接。如果空闲连接没有超过最大连接数那么就放回空闲队列中。否则关闭真实的连接。</li></ol> <h2 id="mybatis中事务模块的设计"><a href="#mybatis中事务模块的设计" class="header-anchor">#</a> MyBatis中事务模块的设计？</h2> <ol><li>谈谈你的事务的理解（ACID）</li> <li>mybatis的事务配置在XML文件中配置：<code>&lt;transactionManager type=&quot;JDBC&quot;&gt;</code></li> <li>在Transaction接口类中定义了事务的基本行为。</li> <li>在MyBatis的事务管理中有两个选择:
<ul><li>jdbc:在MyBatis中自己处理事务的管理.</li> <li>Managed:在MyBatis中没有处理任何的事务操作。这种情况下事务的处理会交给Spring容器来管理.</li></ul></li> <li>在MyBatis中执行DML操作事务的处理逻辑: SqlSesgion.commit();</li></ol> <h2 id="mybatis中mapper接口的设计"><a href="#mybatis中mapper接口的设计" class="header-anchor">#</a> MyBatis中Mapper接口的设计?</h2> <ol><li>谈一下Mybatis中Mapper接口对应的规则：
<ul><li>Mapper 接口方法名和 mapper.xml 中定义的每个 sql 的 id 相同；</li> <li>Mapper 接口方法的输入参数类型和 mapper.xml 中定义的每个 sql 的 parameterType 的类型相同；</li> <li>Mapper 接口方法的输出参数类型和 mapper.xml 中定义的每个 sql 的 resultType 的类型相同；</li> <li>Mapper.xml 文件中的 namespace 即是 mapper 接口的类路径。</li></ul></li> <li>谈下MyBatis中的Mapper接口的设计原理--代理模式的使用。</li> <li>代理对就执行的逻辑的本质还是会执行SqlSession中相关的DML操作的方法</li></ol> <h2 id="为什么需要使用代理对象来处理"><a href="#为什么需要使用代理对象来处理" class="header-anchor">#</a> 为什么需要使用代理对象来处理</h2> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 不适用代理对象的写法</span>
sqlSession<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span> statement<span class="token operator">:</span> <span class="token string">&quot;com.boge.mapper.UserMapper.selectUser&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 使用代理对象的写法</span>
<span class="token class-name">UserMapper</span> mapper <span class="token operator">=</span> sqlSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">UserMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mapper<span class="token punctuation">.</span><span class="token function">selectUserById</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>导致statement出现固定的，耦合性比较强。</p> <h2 id="谈谈你对reflector模块的理解"><a href="#谈谈你对reflector模块的理解" class="header-anchor">#</a> 谈谈你对Reflector模块的理解</h2> <ol><li>Reflector是MyBatis中提供的一个针对反射封装简化的模块:简化反射的相关操作。MyBatis是一个ORM框架。表结构的数据和Java对象中数据的映射。那么不可避免的会存在非常多的反射操作。</li> <li>Reflector是一个独立的模块。我们是可以把这个模块单独抽取出来直接使用的。|</li> <li>每一个Reflector对象都对应一个Java类。</li> <li>反射的具体实现类的分析。</li></ol> <h2 id="谈谈你对mybatis中的类型转换模块的理解"><a href="#谈谈你对mybatis中的类型转换模块的理解" class="header-anchor">#</a> 谈谈你对MyBatis中的类型转换模块的理解</h2> <p><strong>MyBatis在设置预处理语句（PreparedStatement）中的参数或从结果集中取出一个值时，都会用类型处理器将获取到的值以合适的方式转换成Java类型。</strong></p> <p>你可以重写已有的类型处理器或创建你自己的类型处理器来处理不支持的或非标准的类型。 具体做法为：实现 org.apache.ibatis.type.TypeHandler 接口，
或继承一个很便利的类 org.apache.ibatis.type.BaseTypeHandler， 并且可以（可选地）将它映射到一个JDBC类型。比如：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// ExampleTypeHandler.java</span>
<span class="token annotation punctuation">@MappedJdbcTypes</span><span class="token punctuation">(</span><span class="token class-name">JdbcType</span><span class="token punctuation">.</span>VARCHAR<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExampleTypeHandler</span> <span class="token keyword">extends</span> <span class="token class-name">BaseTypeHandler</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setNonNullParameter</span><span class="token punctuation">(</span><span class="token class-name">PreparedStatement</span> ps<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token class-name">String</span> parameter<span class="token punctuation">,</span> <span class="token class-name">JdbcType</span> jdbcType<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
    ps<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> parameter<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getNullableResult</span><span class="token punctuation">(</span><span class="token class-name">ResultSet</span> rs<span class="token punctuation">,</span> <span class="token class-name">String</span> columnName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>columnName<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getNullableResult</span><span class="token punctuation">(</span><span class="token class-name">ResultSet</span> rs<span class="token punctuation">,</span> <span class="token keyword">int</span> columnIndex<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>columnIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getNullableResult</span><span class="token punctuation">(</span><span class="token class-name">CallableStatement</span> cs<span class="token punctuation">,</span> <span class="token keyword">int</span> columnIndex<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> cs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>columnIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- mybatis-config.xml --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>typeHandlers</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>typeHandler</span> <span class="token attr-name">handler</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.mybatis.example.ExampleTypeHandler<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>typeHandlers</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>类型转换处理器的设计: TypeHandler --》 BaseTypeHandler---》具体的TypeHandler
预处理的占位赋值操作。</p> <h2 id="谈谈mybatis和spring的整合的理解"><a href="#谈谈mybatis和spring的整合的理解" class="header-anchor">#</a> 谈谈MyBatis和Spring的整合的理解</h2> <p>回答的比较简单些。梳理下MyBatis和Spring整合的步骤</p> <ul><li>单纯的Spring和MyBatis的整合在</li> <li>SpringBoot项目中的整合</li></ul> <ol><li>添加整合依赖</li></ol> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.mybatis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-spring/artifactId&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.0.4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="2"><li>在mybatis中的配置的数据库源</li></ol> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!--配置数据源--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.mchange.v2.c3p0.comboPooledDataSource<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>datasource<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>driverclass<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.mysql.cj.jdbc.Driver<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
   &lt;property name=&quot;jdbcUrl&quot; value=&quot;jdbc:mysq\://localhost:3306/mybatis-vip?characterEncoding=utf-8&amp;serverTimezone=shanghai&quot;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1236456<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="3"><li>配置Bean</li></ol> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!</span> <span class="token attr-name">--整合mybatis</span> <span class="token attr-name">--</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.mybatis.spring.sqlsessionFactoryBean<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sqlsessionFactoryBean<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!</span> <span class="token attr-name">--关联数据源–-</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dataSource<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>datasource<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token comment">&lt;!--关联mybatis的配置文件--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>configLocation<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>classpath:mybatis-cfg.xml<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token comment">&lt;!--添加别名设置--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>typeAliasesPackage<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com. boge.pojo<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token comment">&lt;!--l映射文件和接口文件不在同一个目录下的时候--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mapperLocations<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>classpath:mapper/*.xml<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="4"><li>配置扫描的路径</li></ol> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!--配置扫描的路径--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.mybatis.spring.mapper.MapperscannerConfigurer<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>basePackage<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.boge.mapper<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="谈谈你对mybatis的理解-2"><a href="#谈谈你对mybatis的理解-2" class="header-anchor">#</a> 谈谈你对MyBatis的理解</h2> <ol><li>MyBatis是一个非常主流的半自动的ORM框架，非常简便的帮助我们完成相关的数据库操作。</li> <li>提供动态SQL，缓存和延迟加载等高级功能。</li> <li>然后整体的架构非常简单,分为三层：外层接口、核心处理、层基础模块。</li></ol> <p><img src="/zhuangxiaoyan/assets/img/Mybatis-arch.6406cccb.png" alt="img.png"></p> <p><img src="/zhuangxiaoyan/assets/img/Mybatis-data.8389f132.png" alt="img.png"></p> <h2 id="如何判定一个类是否线程安全"><a href="#如何判定一个类是否线程安全" class="header-anchor">#</a> 如何判定一个类是否线程安全?</h2> <ol><li>是否有共享的可变状态</li> <li>是否使用了线程安全的数据结构</li> <li>是否使用了同步机制</li> <li>如果类中的共享资源是不可变的</li></ol> <h2 id="sqlsessionfactory和sqlsession是线程安全的吗"><a href="#sqlsessionfactory和sqlsession是线程安全的吗" class="header-anchor">#</a> SqlSessionFactory和SqlSession是线程安全的吗?</h2> <p>SqlSessionFactory是一个接口，具体是查看实现类DefaultSqlSessionFactory ，其中只有一个变量<code>private final Configuration configuration</code> 因此是线程安全的。
SqISession也是一个接口，具体是查看实现类DefaultSqISession。这个类单独使用的时候是线程不安全的。但是整个Spring后是线程安全的。当使用事务的时候的，从当前事务的ThreadLocal中拿到SqlSession。
如果不使用事务的时候，每次执行userMapper.selectXXX的时候都会重新创建一个opensqlsession对象。</p> <p><img src="/zhuangxiaoyan/assets/img/mybatis-sqlsession-safe.340f820b.png" alt="img.png"></p> <h2 id="博文参考"><a href="#博文参考" class="header-anchor">#</a> 博文参考</h2> <ul><li><a href="https://mybatis.net.cn/configuration.html" target="_blank" rel="noopener noreferrer">Mybtis官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/zhuangxiaoyan/interview/redis.html" class="prev">
        Redis面试问题
      </a></span> <span class="next"><a href="/zhuangxiaoyan/interview/mq.html">
        MQ面试问题
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/zhuangxiaoyan/assets/js/app.868ae4fe.js" defer></script><script src="/zhuangxiaoyan/assets/js/2.e0e92cc0.js" defer></script><script src="/zhuangxiaoyan/assets/js/10.f03f824c.js" defer></script>
  </body>
</html>
