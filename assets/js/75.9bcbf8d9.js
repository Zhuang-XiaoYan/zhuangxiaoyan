(window.webpackJsonp=window.webpackJsonp||[]).push([[75],{692:function(t,a,s){"use strict";s.r(a);var e=s(25),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"athena-admin-front容器化部署文档"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#athena-admin-front容器化部署文档"}},[t._v("#")]),t._v(" Athena-Admin-Front容器化部署文档")]),t._v(" "),s("h2",{attrs:{id:"一、安装docker服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、安装docker服务"}},[t._v("#")]),t._v(" 一、安装Docker服务")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 使用国内 daocloud 一键安装命令：")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -sSL https://get.daocloud.io/docker "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("groupadd")]),t._v(" docker "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##添加docker用户组")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" gpasswd -a "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$USER")]),t._v(" docker "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##将登陆用户加入到docker用户组中")]),t._v("\nnewgrp docker "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##更新用户组")]),t._v("\n")])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 安装docker")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -fsSL https://get.docker.com "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("bash")]),t._v(" -s docker --mirror Aliyun\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 启动docker服务")]),t._v("\nsystemctl start docker\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 设置docker开机自启")]),t._v("\nsystemctl "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("enable")]),t._v(" docker\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 配置docker加速器")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" -p /etc/docker\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("tee")]),t._v(" /etc/docker/daemon.json "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<-")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'EOF\'\n{\n  "log-driver": "json-file",\n  "log-opts": {\n    "max-size": "10m",\n    "max-file": "3"\n  }\n}\nEOF')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 重启docker服务")]),t._v("\nsystemctl daemon-reload\nsystemctl restart docker\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Docker安装完成！"')]),t._v("\n")])])]),s("h2",{attrs:{id:"二、编写dockerfile"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、编写dockerfile"}},[t._v("#")]),t._v(" 二、编写Dockerfile")]),t._v(" "),s("div",{staticClass:"language-dockerfile extra-class"},[s("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" node"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("14\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COPY")]),t._v(" ./ /app\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WORKDIR")]),t._v(" /app\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("RUN")]),t._v(" npm install && npm run build\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" nginx\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("RUN")]),t._v(" mkdir /app\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COPY")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("from=0 /app/dist /app\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COPY")]),t._v(" nginx/nginx.conf /etc/nginx/nginx.conf\n")])])]),s("h2",{attrs:{id:"三、添加-dockerignore"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、添加-dockerignore"}},[t._v("#")]),t._v(" 三、添加.dockerignore")]),t._v(" "),s("p",[t._v("设置 .dockerignore 文件能防止 node_modules 和其他中间构建产物被复制到镜像中导致构建问题。")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[t._v("**/node_modules\n**/dist\n")])])]),s("h2",{attrs:{id:"四、编写nginx-conf"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四、编写nginx-conf"}},[t._v("#")]),t._v(" 四、编写nginx.conf")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[t._v('user  nginx;\nworker_processes  1;\n\nerror_log  /var/log/nginx/error.log warn;\npid        /var/run/nginx.pid;\n\nevents {\n  worker_connections  1024;\n}\n\nhttp {\n  include       /etc/nginx/mime.types;\n  default_type  application/octet-stream;\n  log_format  main  \'$remote_addr - $remote_user [$time_local] "$request" \'\n                    \'$status $body_bytes_sent "$http_referer" \'\n                    \'"$http_user_agent" "$http_x_forwarded_for"\';\n  access_log  /var/log/nginx/access.log  main;\n  sendfile        on;\n  keepalive_timeout  65;\n  server {\n    listen       80;\n    server_name  localhost;\n    location / {\n      root   /app;\n      index  index.html;\n      try_files $uri $uri/ /index.html;\n    }\n    error_page   500 502 503 504  /50x.html;\n    location = /50x.html {\n      root   /usr/share/nginx/html;\n    }\n    ## 配置代理，解决跨域问题\n    location /api {\n    \tproxy_pass http://sph-h5-api.atguigu.cn/api;\n    }\n  }\n}\n')])])]),s("h2",{attrs:{id:"五、构建服务镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#五、构建服务镜像"}},[t._v("#")]),t._v(" 五、构建服务镜像")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("docker build "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" -t vue-mall:1.0.0\n")])])]),s("h2",{attrs:{id:"六、拉取镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#六、拉取镜像"}},[t._v("#")]),t._v(" 六、拉取镜像")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("docker pull registry.cn-hangzhou.aliyuncs.com/athena-zhaungxiaoyan/athena-mall-product:1.0.0\n")])])]),s("img",{attrs:{src:t.$withBase("/project/athena-mall/docker-registery.png"),alt:"registery"}}),t._v(" "),s("h2",{attrs:{id:"七、运行容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#七、运行容器"}},[t._v("#")]),t._v(" 七、运行容器")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("docker run --privileged"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true --restart"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("always -name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v("vue-mall -d -p "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v(":80  vue-mall:1.0.0 \n")])])]),s("h2",{attrs:{id:"八、访问服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#八、访问服务"}},[t._v("#")]),t._v(" 八、访问服务")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("http://remote-ip/\n")])])]),s("img",{attrs:{src:t.$withBase("/project/athena-mall/docker-deploy.png"),alt:"deploy"}}),t._v(" "),s("h2",{attrs:{id:"博文参考"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#博文参考"}},[t._v("#")]),t._v(" 博文参考")]),t._v(" "),s("p",[t._v("-"),s("a",{attrs:{href:"https://sms-activate.org/cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("国外的虚拟电话"),s("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=n.exports}}]);